{"version":3,"file":"min.js","sources":["../src/main.js"],"sourcesContent":["const exposed = {};\n\nfunction tweet_(url) {\n  open(\n    \"https://twitter.com/intent/tweet?url=\" + encodeURIComponent(url),\n    \"_blank\"\n  );\n}\nfunction tweet(anchor) {\n  tweet_(anchor.getAttribute(\"href\"));\n}\nexpose(\"tweet\", tweet);\n\nfunction share(anchor) {\n  var url = anchor.getAttribute(\"href\");\n  event.preventDefault();\n  if (navigator.share) {\n    navigator.share({\n      url: url,\n    });\n  } else if (navigator.clipboard) {\n    navigator.clipboard.writeText(url);\n    message(\"Article URL copied to clipboard.\");\n  } else {\n    tweet_(url);\n  }\n}\nexpose(\"share\", share);\n\nfunction message(msg) {\n  var dialog = document.getElementById(\"message\");\n  dialog.textContent = msg;\n  dialog.setAttribute(\"open\", \"\");\n  setTimeout(function () {\n    dialog.removeAttribute(\"open\");\n  }, 3000);\n}\n\nfunction prefetch(e) {\n  if (e.target.tagName != \"A\") {\n    return;\n  }\n  if (e.target.origin != location.origin) {\n    return;\n  }\n  /**\n   * Return the given url with no fragment\n   * @param {string} url potentially containing a fragment\n   * @return {string} url without fragment\n   */\n  const removeUrlFragment = (url) => url.split(\"#\")[0];\n  if (\n    removeUrlFragment(window.location.href) === removeUrlFragment(e.target.href)\n  ) {\n    return;\n  }\n  var l = document.createElement(\"link\");\n  l.rel = \"prefetch\";\n  l.href = e.target.href;\n  document.head.appendChild(l);\n}\ndocument.documentElement.addEventListener(\"mouseover\", prefetch, {\n  capture: true,\n  passive: true,\n});\ndocument.documentElement.addEventListener(\"touchstart\", prefetch, {\n  capture: true,\n  passive: true,\n});\n\n/**\n * Injects a script into document.head\n * @param {string} src path of script to be injected in <head>\n * @return {Promise} Promise object that resolves on script load event\n */\nconst dynamicScriptInject = (src) => {\n  return new Promise((resolve) => {\n    const script = document.createElement(\"script\");\n    script.src = src;\n    script.type = \"text/javascript\";\n    document.head.appendChild(script);\n    script.addEventListener(\"load\", () => {\n      resolve(script);\n    });\n  });\n};\n\n// Script web-vitals.js will be injected dynamically if user opts-in to sending CWV data.\nconst sendWebVitals = document.currentScript.getAttribute(\"data-cwv-src\");\n\nif (/web-vitals.js/.test(sendWebVitals)) {\n  dynamicScriptInject(`${window.location.origin}/js/web-vitals.js`)\n    .then(() => {\n      webVitals.getCLS(sendToGoogleAnalytics);\n      webVitals.getFID(sendToGoogleAnalytics);\n      webVitals.getLCP(sendToGoogleAnalytics);\n    })\n    .catch((error) => {\n      console.error(error);\n    });\n}\n\naddEventListener(\n  \"click\",\n  function (e) {\n    var button = e.target.closest(\"button\");\n    if (!button) {\n      return;\n    }\n    ga(\"send\", {\n      hitType: \"event\",\n      eventCategory: \"button\",\n      eventAction: button.getAttribute(\"aria-label\") || button.textContent,\n    });\n  },\n  true\n);\nvar selectionTimeout;\naddEventListener(\n  \"selectionchange\",\n  function () {\n    clearTimeout(selectionTimeout);\n    var text = String(document.getSelection()).trim();\n    if (text.split(/[\\s\\n\\r]+/).length < 3) {\n      return;\n    }\n    selectionTimeout = setTimeout(function () {\n      ga(\"send\", {\n        hitType: \"event\",\n        eventCategory: \"selection\",\n        eventAction: text,\n      });\n    }, 2000);\n  },\n  true\n);\n\nfunction expose(name, fn) {\n  exposed[name] = fn;\n}\n\naddEventListener(\"click\", (e) => {\n  const handler = e.target.closest(\"[on-click]\");\n  if (!handler) {\n    return;\n  }\n  e.preventDefault();\n  const name = handler.getAttribute(\"on-click\");\n  const fn = exposed[name];\n  if (!fn) {\n    throw new Error(\"Unknown handler\" + name);\n  }\n  fn(handler);\n});\n\nfunction removeBlurredImage(img) {\n  // Ensure the browser doesn't try to draw the placeholder when the real image is present.\n  img.style.backgroundImage = \"none\";\n}\ndocument.body.addEventListener(\n  \"load\",\n  (e) => {\n    if (e.target.tagName != \"IMG\") {\n      return;\n    }\n    removeBlurredImage(e.target);\n  },\n  /* capture */ \"true\"\n);\nfor (let img of document.querySelectorAll(\"img\")) {\n  if (img.complete) {\n    removeBlurredImage(img);\n  }\n}\n"],"names":["exposed","tweet_","url","open","encodeURIComponent","prefetch","e","target","tagName","origin","location","removeUrlFragment","split","window","href","l","document","createElement","rel","head","appendChild","expose","anchor","getAttribute","msg","dialog","event","preventDefault","navigator","share","clipboard","writeText","getElementById","textContent","setAttribute","setTimeout","removeAttribute","documentElement","addEventListener","capture","passive","sendWebVitals","currentScript","src","selectionTimeout","name","fn","removeBlurredImage","img","style","backgroundImage","test","Promise","resolve","script","type","then","webVitals","getCLS","sendToGoogleAnalytics","getFID","getLCP","catch","error","console","button","closest","ga","hitType","eventCategory","eventAction","clearTimeout","text","String","getSelection","trim","length","handler","Error","body","querySelectorAll","complete"],"mappings":"yBAAA,MAAMA,EAAU,GAEhB,SAASC,EAAOC,GACdC,KACE,wCAA0CC,mBAAmBF,GAC7D,UAiCJ,SAASG,EAASC,GAChB,GAAwB,KAApBA,EAAEC,OAAOC,QACX,OAEF,GAAIF,EAAEC,OAAOE,QAAUC,SAASD,OAC9B,OAOF,MAAME,EAAqBT,GAAQA,EAAIU,MAAM,KAAK,GAClD,GACED,EAAkBE,OAAOH,SAASI,QAAUH,EAAkBL,EAAEC,OAAOO,MADzE,CAKA,IAAIC,EAAIC,SAASC,cAAc,QAC/BF,EAAEG,IAAM,WACRH,EAAED,KAAOR,EAAEC,OAAOO,KAClBE,SAASG,KAAKC,YAAYL,IAhD5BM,EAAO,SAHP,SAAeC,GACbrB,EAAOqB,EAAOC,aAAa,YAkB7BF,EAAO,SAdP,SAAeC,GACb,IAeeE,EACXC,EAhBAvB,EAAMoB,EAAOC,aAAa,QAC9BG,MAAMC,iBACFC,UAAUC,MACZD,UAAUC,MAAM,CACd3B,IAAKA,IAEE0B,UAAUE,WACnBF,UAAUE,UAAUC,UAAU7B,GAQjBsB,EAPL,oCAQNC,EAAST,SAASgB,eAAe,YAC9BC,YAAcT,EACrBC,EAAOS,aAAa,OAAQ,IAC5BC,YAAW,WACTV,EAAOW,gBAAgB,UACtB,MAXDnC,EAAOC,MAqCXc,SAASqB,gBAAgBC,iBAAiB,YAAajC,EAAU,CAC/DkC,SAAS,EACTC,SAAS,IAEXxB,SAASqB,gBAAgBC,iBAAiB,aAAcjC,EAAU,CAChEkC,SAAS,EACTC,SAAS,IAQX,MAaMC,EAAgBzB,SAAS0B,cAAcnB,aAAa,gBAb9B,IAACoB,EA0CzBC,EAoBJ,SAASvB,EAAOwB,EAAMC,GACpB9C,EAAQ6C,GAAQC,EAiBlB,SAASC,EAAmBC,GAE1BA,EAAIC,MAAMC,gBAAkB,OAnE1B,gBAAgBC,KAAKV,KAfIE,EAgBJ9B,OAAOH,SAASD,OAAnB,oBAfb,IAAI2C,QAASC,IAClB,MAAMC,EAAStC,SAASC,cAAc,UACtCqC,EAAOX,IAAMA,EACbW,EAAOC,KAAO,kBACdvC,SAASG,KAAKC,YAAYkC,GAC1BA,EAAOhB,iBAAiB,OAAQ,KAC9Be,EAAQC,QAUTE,KAAK,KACJC,UAAUC,OAAOC,uBACjBF,UAAUG,OAAOD,uBACjBF,UAAUI,OAAOF,yBAElBG,MAAOC,IACNC,QAAQD,MAAMA,KAIpBzB,iBACE,SACA,SAAUhC,GACR,IAAI2D,EAAS3D,EAAEC,OAAO2D,QAAQ,UACzBD,GAGLE,GAAG,OAAQ,CACTC,QAAS,QACTC,cAAe,SACfC,YAAaL,EAAO1C,aAAa,eAAiB0C,EAAOhC,iBAG7D,GAGFK,iBACE,mBACA,WACEiC,aAAa3B,GACb,IAAI4B,EAAOC,OAAOzD,SAAS0D,gBAAgBC,OACvCH,EAAK5D,MAAM,aAAagE,OAAS,IAGrChC,EAAmBT,YAAW,WAC5BgC,GAAG,OAAQ,CACTC,QAAS,QACTC,cAAe,YACfC,YAAaE,MAEd,SAEL,GAOFlC,iBAAiB,QAAUhC,IACzB,MAAMuE,EAAUvE,EAAEC,OAAO2D,QAAQ,cACjC,IAAKW,EACH,OAEFvE,EAAEqB,iBACF,MAAMkB,EAAOgC,EAAQtD,aAAa,YAC5BuB,EAAK9C,EAAQ6C,GACnB,IAAKC,EACH,MAAM,IAAIgC,MAAM,kBAAoBjC,GAEtCC,EAAG+B,KAOL7D,SAAS+D,KAAKzC,iBACZ,OACChC,IACyB,OAApBA,EAAEC,OAAOC,SAGbuC,EAAmBzC,EAAEC,SAET,QAEhB,IAAK,IAAIyC,KAAOhC,SAASgE,iBAAiB,OACpChC,EAAIiC,UACNlC,EAAmBC"}