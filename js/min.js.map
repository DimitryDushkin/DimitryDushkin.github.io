{"version":3,"file":"min.js","sources":["../src/main.js"],"sourcesContent":["const exposed = {};\n\nfunction tweet_(url) {\n  open(\n    \"https://twitter.com/intent/tweet?url=\" + encodeURIComponent(url),\n    \"_blank\"\n  );\n}\nfunction tweet(anchor) {\n  tweet_(anchor.getAttribute(\"href\"));\n}\nexpose(\"tweet\", tweet);\n\nfunction share(anchor) {\n  var url = anchor.getAttribute(\"href\");\n  event.preventDefault();\n  if (navigator.share) {\n    navigator.share({\n      url: url,\n    });\n  } else if (navigator.clipboard) {\n    navigator.clipboard.writeText(url);\n    message(\"Article URL copied to clipboard.\");\n  } else {\n    tweet_(url);\n  }\n}\nexpose(\"share\", share);\n\nfunction message(msg) {\n  var dialog = document.getElementById(\"message\");\n  dialog.textContent = msg;\n  dialog.setAttribute(\"open\", \"\");\n  setTimeout(function () {\n    dialog.removeAttribute(\"open\");\n  }, 3000);\n}\n\nfunction prefetch(e) {\n  if (e.target.tagName != \"A\") {\n    return;\n  }\n  if (e.target.origin != location.origin) {\n    return;\n  }\n  /**\n   * Return the given url with no fragment\n   * @param {string} url potentially containing a fragment\n   * @return {string} url without fragment\n   */\n  const removeUrlFragment = (url) => url.split(\"#\")[0];\n  if (\n    removeUrlFragment(window.location.href) === removeUrlFragment(e.target.href)\n  ) {\n    return;\n  }\n  var l = document.createElement(\"link\");\n  l.rel = \"prefetch\";\n  l.href = e.target.href;\n  document.head.appendChild(l);\n}\ndocument.documentElement.addEventListener(\"mouseover\", prefetch, {\n  capture: true,\n  passive: true,\n});\ndocument.documentElement.addEventListener(\"touchstart\", prefetch, {\n  capture: true,\n  passive: true,\n});\n\nfunction expose(name, fn) {\n  exposed[name] = fn;\n}\n\naddEventListener(\"click\", (e) => {\n  const handler = e.target.closest(\"[on-click]\");\n  if (!handler) {\n    return;\n  }\n  e.preventDefault();\n  const name = handler.getAttribute(\"on-click\");\n  const fn = exposed[name];\n  if (!fn) {\n    throw new Error(\"Unknown handler\" + name);\n  }\n  fn(handler);\n});\n\nfunction removeBlurredImage(img) {\n  // Ensure the browser doesn't try to draw the placeholder when the real image is present.\n  img.style.backgroundImage = \"none\";\n}\nwindow.addEventListener(\n  \"load\",\n  (e) => {\n    if (e.target.tagName != \"IMG\") {\n      return;\n    }\n    removeBlurredImage(e.target);\n  },\n  /* capture */ \"true\"\n);\nfor (let img of document.querySelectorAll(\"img\")) {\n  if (img.complete) {\n    removeBlurredImage(img);\n  }\n}\n"],"names":["exposed","tweet_","url","open","encodeURIComponent","prefetch","e","target","tagName","origin","location","removeUrlFragment","split","window","href","l","document","createElement","rel","head","appendChild","expose","name","fn","removeBlurredImage","img","style","backgroundImage","anchor","getAttribute","msg","dialog","event","preventDefault","navigator","share","clipboard","writeText","getElementById","textContent","setAttribute","setTimeout","removeAttribute","documentElement","addEventListener","capture","passive","handler","closest","Error","querySelectorAll","complete"],"mappings":"yBAAA,MAAMA,EAAU,GAEhB,SAASC,EAAOC,GACdC,KACE,wCAA0CC,mBAAmBF,GAC7D,UAiCJ,SAASG,EAASC,GAChB,GAAwB,KAApBA,EAAEC,OAAOC,QACX,OAEF,GAAIF,EAAEC,OAAOE,QAAUC,SAASD,OAC9B,OAOF,MAAME,EAAqBT,GAAQA,EAAIU,MAAM,KAAK,GAClD,GACED,EAAkBE,OAAOH,SAASI,QAAUH,EAAkBL,EAAEC,OAAOO,MADzE,CAKA,IAAIC,EAAIC,SAASC,cAAc,QAC/BF,EAAEG,IAAM,WACRH,EAAED,KAAOR,EAAEC,OAAOO,KAClBE,SAASG,KAAKC,YAAYL,IAW5B,SAASM,EAAOC,EAAMC,GACpBvB,EAAQsB,GAAQC,EAiBlB,SAASC,EAAmBC,GAE1BA,EAAIC,MAAMC,gBAAkB,OA/E9BN,EAAO,SAHP,SAAeO,GACb3B,EAAO2B,EAAOC,aAAa,YAkB7BR,EAAO,SAdP,SAAeO,GACb,IAeeE,EACXC,EAhBA7B,EAAM0B,EAAOC,aAAa,QAC9BG,MAAMC,iBACFC,UAAUC,MACZD,UAAUC,MAAM,CACdjC,IAAKA,IAEEgC,UAAUE,WACnBF,UAAUE,UAAUC,UAAUnC,GAQjB4B,EAPL,oCAQNC,EAASf,SAASsB,eAAe,YAC9BC,YAAcT,EACrBC,EAAOS,aAAa,OAAQ,IAC5BC,YAAW,WACTV,EAAOW,gBAAgB,UACtB,MAXDzC,EAAOC,MAqCXc,SAAS2B,gBAAgBC,iBAAiB,YAAavC,EAAU,CAC/DwC,SAAS,EACTC,SAAS,IAEX9B,SAAS2B,gBAAgBC,iBAAiB,aAAcvC,EAAU,CAChEwC,SAAS,EACTC,SAAS,IAOXF,iBAAiB,QAAUtC,IACzB,MAAMyC,EAAUzC,EAAEC,OAAOyC,QAAQ,cACjC,IAAKD,EACH,OAEFzC,EAAE2B,iBACF,MAAMX,EAAOyB,EAAQlB,aAAa,YAC5BN,EAAKvB,EAAQsB,GACnB,IAAKC,EACH,MAAM,IAAI0B,MAAM,kBAAoB3B,GAEtCC,EAAGwB,KAOLlC,OAAO+B,iBACL,OACCtC,IACyB,OAApBA,EAAEC,OAAOC,SAGbgB,EAAmBlB,EAAEC,SAET,QAEhB,IAAK,IAAIkB,KAAOT,SAASkC,iBAAiB,OACpCzB,EAAI0B,UACN3B,EAAmBC"}