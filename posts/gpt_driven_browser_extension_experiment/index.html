<!DOCTYPE html><html domain="dushkin.tech" lang="en"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1" name="viewport"><link href="/img/favicon/apple-touch-icon.png?hash=59d9e0e5b0" rel="apple-touch-icon" sizes="180x180"><link href="/img/favicon/favicon-32x32.png?hash=3efd12fae9" rel="icon" type="image/png" sizes="32x32"><link href="/img/favicon/favicon-16x16.png?hash=c62836a972" rel="icon" type="image/png" sizes="16x16"><link href="/img/favicon/site.webmanifest?hash=df884c5d9d" rel="manifest"><link href="/img/favicon/safari-pinned-tab.svg?hash=faeecd6d45" rel="mask-icon" color="#5bbad5"><meta content="#da532c" name="msapplication-TileColor"><link href="/img/favicon/android-chrome-192x192.png?hash=b5d5df46f5" rel="icon" type="image/png"><meta content="#ffe6b7" name="theme-color"><meta content="max-snippet:-1, max-image-preview: large, max-video-preview: -1" name="robots"><title>Creating browser extension with ChatGPT as a main development driver (spoiler: it's a mess :)) | Dmitrii Dushkin blog</title><meta content="Creating browser extension with ChatGPT as a main development driver (spoiler: it's a mess :))" property="og:title"><meta content="Small experiment with ChatGPT as a development driver of a Chrome Extension that generates summaries (via GPT) for an article on the current webpage. Source code included." name="description"><meta content="Small experiment with ChatGPT as a development driver of a Chrome Extension that generates summaries (via GPT) for an article on the current webpage. Source code included." property="og:description"><meta content="summary_large_image" name="twitter:card"><meta content="@sky2high0" name="twitter:site"><meta content="@sky2high0" name="twitter:creator"><meta content="https://dushkin.tech/img/for_posts/gpt-toolbelt/gpt-toolbelt-blog-post-image.jpg" property="og:image"><link href="https://dushkin.tech/posts/gpt_driven_browser_extension_experiment/" rel="canonical"><meta content="no-referrer-when-downgrade" name="referrer"><link href="/feed/feed.xml" rel="alternate" type="application/atom+xml" title="Dmitrii's tech blog"><link href="/" rel="preconnect" crossorigin=""><link href="https://fonts.googleapis.com" rel="preconnect"><link href="https://fonts.gstatic.com" rel="preconnect" crossorigin=""><link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,500;0,700;1,500;1,700&amp;display=swap" rel="stylesheet"><script async="" src="/js/min.js?hash=e9bb8a8457" defer=""></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BJQNRSC76D"></script><script csp-hash="sha256-TVz+2vN3+ZgiiRPB9uCg0Ay6n/8PgEf0tWGg3Bcy+DU=">window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-BJQNRSC76D');</script><script csp-hash="sha256-Ky9qZOPnMhQV/s7Fdb9TYAOfU4KtWNqCZaFK8tSzXa0=">if (/Mac OS X/.test(navigator.userAgent))document.documentElement.classList.add('apple')</script><style>header{text-align:center;display:flex;align-items:center;flex-direction:column}header nav{padding:.375em 0;align-self:flex-start;display:flex;gap:16px}header nav h1{float:left;font-size:inherit;line-height:inherit;margin:0;text-align:left}header nav a{font-weight:700;text-decoration:none}.tag{display:inline-block;background-color:var(--background-alt);color:var(--text-muted);border-radius:12px;padding:4px 8px;margin:4px 4px 0 0}:root{--background-body: #fffff6;--background: #efefef;--background-alt: #f7f7f7;--selection: #9e9e9e;--text-main: #363636;--text-bright: #000;--text-muted: #63686d;--links: #0076d1;--border: #dbdbdb;--code: #000}@media (prefers-color-scheme:dark){:root{--background-body: #202b38;--background: #161f27;--background-alt: #1a242f;--selection: #1c76c5;--text-main: #dbdbdb;--text-bright: #fff;--text-muted: #a9b1ba;--links: #41adff;--focus: #0096bfab;--border: #526980;--code: #ffbe85;--animation-duration: 0.1s;--button-base: #0c151c;--button-hover: #040a0f;--form-placeholder: #a9a9a9;--form-text: #fff;--variable: #d941e2;--highlight: #efdb43}}html{scrollbar-width:thin;font-family:"Nunito",sans-serif;font-size:17px}body{max-width:800px;margin:20px auto;padding:0 10px;word-wrap:break-word;color:#363636;color:var(--text-main);background:#fff;background:var(--background-body);text-rendering:optimizeLegibility}@media (prefers-color-scheme:dark){body{background:#202b38;background:var(--background-body);color:#dbdbdb;color:var(--text-main)}}h1{font-size:2.2em}code,h1,h2{color:#000}h1,h2{margin-bottom:12px;margin-top:24px;color:var(--text-bright)}@media (prefers-color-scheme:dark){h1{color:#fff;color:var(--text-bright)}}@media (prefers-color-scheme:dark){h2{color:#fff;color:var(--text-bright)}}h1,h2{font-weight:600}a>code{color:inherit}a{text-decoration:none;color:#0076d1;color:var(--links)}@media (prefers-color-scheme:dark){a{color:#41adff;color:var(--links)}}a:hover{text-decoration:underline}code{background:#efefef;background:var(--background);color:var(--code);padding:2.5px 5px;border-radius:6px;font-size:1em}@media (prefers-color-scheme:dark){code{color:#ffbe85;color:var(--code);background:#161f27;background:var(--background)}}img{max-width:100%;height:auto;border-radius:8px}::selection{background-color:#9e9e9e;background-color:var(--selection);color:#000;color:var(--text-bright)}@media (prefers-color-scheme:dark){::selection{color:#fff;color:var(--text-bright);background-color:#1c76c5;background-color:var(--selection)}}footer{border-top:1px solid #dbdbdb;border-top:1px solid var(--border);padding-top:10px;color:#70777f;color:var(--text-muted)}@media (prefers-color-scheme:dark){footer{color:#a9b1ba;color:var(--text-muted);border-top:1px solid #526980;border-top:1px solid var(--border)}}body>footer{margin-top:40px}article{max-width:70ch;margin:auto}aside{font-style:italic}@media (prefers-color-scheme:dark){img{filter:brightness(80%);box-shadow:inset 0 0 85px rgba(0,0,0,.4)}}p{margin:1em 0 -2px}.cover-image{margin-top:1rem;width:100%;max-height:45vh;object-fit:cover}main img{content-visibility:auto}share-widget{position:fixed;right:20px;bottom:20px;opacity:.9}share-widget div{width:30px;height:30px;background-image:url(/img/share.svg);background-repeat:no-repeat;background-position:center}.apple share-widget div{background-image:url(/img/share-apple.svg)}share-widget button{margin:0}share-widget button:active{transform:scale(1.2)}</style></head><body><header><nav><h1><a href="/" title="Home">Dmitrii's tech blog</a></h1><a href="/about/">About me</a></nav><h1>Creating browser extension with ChatGPT as a main development driver (spoiler: it's a mess :))</h1><aside>3 min read</aside><dialog id="message"></dialog></header><main><article><img src="/img/for_posts/gpt-toolbelt/gpt-toolbelt-blog-post-image.jpg" class="cover-image"><p>I decided to join a wave and write a simple browser extension relying on ChatGPT help. The extension uses GPT to summarise the article on the current page.<br>At first, everything looked surprisingly smooth. GPT gave a complete file structure and contents for it. Wow!üò≤</p><p><img src="/img/for_posts/gpt-toolbelt/gpt-response-0.png" alt="GPT response on initial request"></p><h2 id="bug-one---old-api">Bug one - Old API <a href="#bug-one---old-api" class="direct-link">#</a></h2><p>It was not working, though, since it was replaced with comments article's content extraction and API calls. But It's okay.<br>After asking to use a specific library for extraction (Readability.js) and a particular OpenAI API for summarisation, it produced, at first sight, quite worthy code. With one minor issue -- it was not working. ü§∑‚Äç‚ôÇÔ∏è I asked how to debug an extension and started debugging.</p><p>The first issue was that GPT suggested using old (inexistent) OpenAI API. I googled the current one and modified the code.</p><h2 id="bug-two---%22forgot%22-about-permissions-to-not-used-chrome-api">Bug two - "forgot" about permissions to not used Chrome API <a href="#bug-two---%22forgot%22-about-permissions-to-not-used-chrome-api" class="direct-link">#</a></h2><p>Secondly, it used <code>chrome.local.storage</code> but forgot to set permissions for it in manifest.json. I showed GPT an error, and GPT apologised and answered with the correct instructions.</p><p>The funny thing is that storage is not used anyhow in the app! ü•≤<br>I asked GPT, "why do you need storage anyway?".<br>GPT:<br><img src="/img/for_posts/gpt-toolbelt/gpt-response-1.jpg" alt="GPT response on storage question"></p><p>Finally, we are at the stage of making the correct API request without errors in JS!</p><h2 id="bug-three---incorrect-api-request-params">Bug three - incorrect API request params <a href="#bug-three---incorrect-api-request-params" class="direct-link">#</a></h2><p>But it turned out it wasn't initially correctly calling API. I inspected the API response and found that it returned empty <code>choices[0].text and choices[0].finish_reason === "length"</code><br><img src="/img/for_posts/gpt-toolbelt/gpt-response-2.jpg" alt="GPT response on API question"></p><p>Okay, it so turned out max_tokens shouldn't be 0. Who would have thought...</p><h2 id="bug-four---mess-after-multiple-rewrites">Bug four - mess after multiple rewrites <a href="#bug-four---mess-after-multiple-rewrites" class="direct-link">#</a></h2><p>Let's try again. It was not working. A problem in <code>background.js</code>, it cannot read the id from the tab. Telling the error again and got a fixed version.<br>At last, behold the successfully functioning extension!<br><img src="/img/for_posts/gpt-toolbelt/gpt-toolbelt-screenshot.jpeg" alt="Screenshot of working browser extension summarising article"></p><p>The code can be improved by the way. For instance, great articles can easily exceed the input of the used model (varies for different models). It's 1500 words for most models. And around 7000 for a few more expensive ones.</p><h2 id="conclusion">Conclusion <a href="#conclusion" class="direct-link">#</a></h2><p>It's really impressive if you know what you are doing! It helped me to skip the boring steps of exploring Chrome Extension API (although I'm a bit familiar with it) and concentrate on exciting part -- working with GPT API.</p><p>But it produced buggy code. It looks like during a single response, it's not taking into account a beginning of a reply. Meaning that it produced valid <code>manifest.json</code> at first but while it was writing <code>background.js</code> and started using Storage API it "forgot" that permissions for it wasn't included in <code>manifest.json</code> in the first place.</p><p>Is it a fundamental flaw of LLM since it's essentially an "autocomplete" or it's a limitation of the current utilisation method? Will see :)</p><p>Extension's source code - <a href="https://github.com/DimitryDushkin/gpt-toolbelt">https://github.com/DimitryDushkin/gpt-toolbelt</a></p><div style="margin-top: 24px"><a href="/tags/gpt/" class="tag">#gpt</a> <a href="/tags/large-language-model/" class="tag">#large language model</a> <a href="/tags/javascript/" class="tag">#javascript</a></div><h1>***</h1><p>Since you've made it this far, <a href="https://dushkin.tech/posts/gpt_driven_browser_extension_experiment/" on-click="share">sharing</a> this article on your favorite social media network would be highly appreciated üíñ! For feedback, please <a href="https://twitter.com/sky2high0" rel="noopener" target="_blank">ping me on Twitter</a>.</p><share-widget><button aria-label="Share" href="https://dushkin.tech/posts/gpt_driven_browser_extension_experiment/" on-click="share"><div></div></button></share-widget><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Creating browser extension with ChatGPT as a main development driver (spoiler: it&#39;s a mess :))","image":["https://dushkin.tech/img/for_posts/gpt-toolbelt/gpt-toolbelt-blog-post-image.jpg","https://dushkin.tech/img/for_posts/gpt-toolbelt/gpt-response-0.png","https://dushkin.tech/img/for_posts/gpt-toolbelt/gpt-response-1.jpg","https://dushkin.tech/img/for_posts/gpt-toolbelt/gpt-response-2.jpg","https://dushkin.tech/img/for_posts/gpt-toolbelt/gpt-toolbelt-screenshot.jpeg"],"author":"Dmitrii Dushkin","genre":"software development","publisher":{"@type":"Organization","name":"Dmitrii Dushkin","logo":{"@type":"ImageObject","url":"/img/favicon/android-chrome-192x192.png?hash=b5d5df46f5"}},"url":"https://dushkin.tech/posts/gpt_driven_browser_extension_experiment/","mainEntityOfPage":"https://dushkin.tech/posts/gpt_driven_browser_extension_experiment/","datePublished":"2023-03-26","dateModified":"2023-10-21","description":"I decided to join a wave and write a simple browser extension relying on ChatGPT help. The extension uses GPT to summarise the article on..."}</script><p>Published <time datetime="2023-03-26">26 Mar 2023</time></p></article></main><footer><a href="/about/">Dmitrii Dushkin</a></footer></body></html>